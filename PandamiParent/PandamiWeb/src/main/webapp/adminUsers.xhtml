<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/masterPageAdmin.xhtml">
	<ui:define name="title">Admin - utilisateurs</ui:define>
	<ui:define name="content">
		<div id="main">
			<div>Visualisation de l'ensemble des utilisateurs</div>
			<h:form id="adminUsersForm">
				
				<p:growl id="msgs" showDetail="true"/>
			
				<p:dataTable id="adminUsersDataTable" var="user" value="#{mbAdmin.users}" reflow="true" rows="30" size="large"
					widgetVar="adminUserTable" editable="true" editMode="cell"
                    editInitEvent="dblclick" emptyMessage="Aucun utilisateur à afficher"
					rowIndexVar="rowIndex" stripedRows="false" selection="#{mbAdmin.selectedUser}">

		            <p:ajax event="cellEdit" listener="#{mbAdmin.onUserCellEdit}" update=":adminUsersForm:msgs"/>

					<p:column headerText="Utilisateur n°" sortBy="#{user.id}">
						<h:outputText value="#{user.id}" />
					</p:column>
					
					<p:column headerText="Type d'utilisateur"	sortBy="#{user.userType.type}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.userType.type}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:selectOneMenu value="#{mbAdmin.selectedUser.userType}" converter="omnifaces.SelectItemsConverter">
                            		<f:selectItems value="#{mbAdmin.userTypes}" var="userType" itemLabel="#{userType.type}" itemValue="#{userType}"/>
                        		</h:selectOneMenu>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
					
					<p:column headerText="Civilité"	sortBy="#{user.gender.name}">
						<p:cellEditor>
                    		<f:facet name="output">
                    			<h:graphicImage value="/resources/IMG/male.svg" rendered="#{user.gender.name.equals('Homme')}" alt="Homme" style="width: 30px"/>
                    			<h:graphicImage value="/resources/IMG/female.svg" rendered="#{user.gender.name.equals('Femme')}" alt="Femme" style="width: 30px"/>
                    		</f:facet>
                    		<f:facet name="input">
                        		<h:selectOneMenu value="#{mbAdmin.selectedUser.gender}" converter="omnifaces.SelectItemsConverter">
                            		<f:selectItems value="#{mbAdmin.genders}" var="gender" itemLabel="#{gender.name}" itemValue="#{gender}"/>
                        		</h:selectOneMenu>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
					
					<p:column headerText="Nom"	sortBy="#{user.surname}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.surname.toUpperCase()}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.surname}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
					
					<p:column headerText="Prénom"	sortBy="#{user.name}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.name}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.name}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
					
					<p:column headerText="Date de naissance"	sortBy="#{user.birthDate}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.birthDate}" converter="localDateConverter"/>
                    		</f:facet>
                    		<f:facet name="input">
                        		<p:datePicker id="actionDatePicker"	value="#{user.birthDate}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
							
					<p:column headerText="Login" sortBy="#{user.login}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.login}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.login}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
										
					<p:column headerText="Mot de passe"	sortBy="#{user.password}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.password}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.password}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
															
					<p:column headerText="Téléphone"	sortBy="#{user.phoneNumber}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.phoneNumber}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.phoneNumber}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
													
					<p:column headerText="Voie"	sortBy="#{user.street}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.street}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.street}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
					
					<p:column headerText="CP - Ville"	sortBy="#{user.city.zipCode}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.city.zipCode} - #{user.city.name}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:selectOneMenu value="#{mbAdmin.selectedUser.city}" converter="omnifaces.SelectItemsConverter">
                            		<f:selectItems value="#{mbAdmin.cities}" var="city" itemLabel="#{city.zipCode} - #{city.name}" itemValue="#{city}"/>
                        		</h:selectOneMenu>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
																		
					<p:column headerText="E-mail"	sortBy="#{user.email}" >
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.email}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.email}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
																							
					<p:column headerText="Nom contact d'urgence" sortBy="#{user.emergencyContactSurname}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.emergencyContactSurname.toUpperCase()}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.emergencyContactSurname}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
																							
					<p:column headerText="Prénom contact d'urgence"	sortBy="#{user.emergencyContactName}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.emergencyContactName}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.emergencyContactName}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
																							
					<p:column headerText="Téléphone contact d'urgence"	sortBy="#{user.emergencyContactPhoneNumber}">
						<p:cellEditor>
                    		<f:facet name="output">
                        		<h:outputText value="#{user.emergencyContactPhoneNumber}"/>
                    		</f:facet>
                    		<f:facet name="input">
                            	<h:inputText value="#{user.emergencyContactPhoneNumber}"/>
                    		</f:facet>
                		</p:cellEditor>
					</p:column>
				</p:dataTable>
			</h:form>
		</div>
	</ui:define>

	<ui:define name="CSS">
		<h:outputStylesheet name="CSS/adminUsers.css" />
	</ui:define>
</ui:composition>
</html>